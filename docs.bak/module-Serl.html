<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Module: Serl</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Module: Serl</h1>

    




<section>

<header>
    
        
            
        
    
</header>

<article>
    <div class="container-overview">
    
        
            <div class="description"><p>'export class/function' chosen over an (export default) expression for explicitness:</p></div>
        

        
            















<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="serl.js.html">serl.js</a>, <a href="serl.js.html#line1">line 1</a>
    </li></ul></dd>
    

    

    

    
    <dt class="tag-todo">To Do:</dt>
    <dd class="tag-todo">
        <ul>
            <li>Make an Atom() class datatype?</li>
        
            <li>Check each METHOD... should it be .STATIC or #INSTANCE?</li>
        
            <li>Proxy the 'console' object so that we can toggle debug levels</li>
        
            <li>serl.js should be serl.mjs - but the lousy dev server doesn't serve the right
 mime type</li>
        
            <li>https://docsify.js.org/#/quickstart ?</li>
        
            <li>export class Reference ()</li>
        </ul>
    </dd>
    
</dl>




















        
    
    </div>

    

    

    
        <h3 class="subsection-title">Classes</h3>

        <dl>
            <dt><a href="module-Serl.Node.html">Node</a></dt>
            <dd></dd>
        
            <dt><a href="module-Serl.Pid.html">Pid</a></dt>
            <dd></dd>
        
            <dt><a href="module-Serl.Proc.html">Proc</a></dt>
            <dd></dd>
        </dl>
    

    

    

    
        <h3 class="subsection-title">Namespaces</h3>

        <dl>
            <dt><a href="module-Serl._Node_nodeMap_.html">'Node#nodeMap'</a></dt>
            <dd></dd>
        
            <dt><a href="module-Serl._Node_procMap_.html">'Node#procMap'</a></dt>
            <dd></dd>
        </dl>
    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id=".cloneFun"><span class="type-signature">(static) </span>cloneFun<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    <p>Serl uses this interface to ensure that functions passed to
<a href="module-Serl.Node.html#spawn">spawn/n</a> (which spawn/n assigns to new procs) are truly portable lambdas,
where the function body has no variables in scope which were defined outside
the function body. Architects deploying Serl may choose to overwrite the
default implementation of the interface, with their own custom code, or a
third-party library.</p>
</div>













    <h5 class="subsection-title">Properties:</h5>

    

<table class="props">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>module:Serl.serialReplacer</code></td>
            

            <td class="type">
            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>




<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="serl.js.html">serl.js</a>, <a href="serl.js.html#line842">line 842</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><p><a href="module-Serl.Node.html#spawn">WARNING</a> under spawn/n</p></li>
        
            <li><p>Related: on <a href="https://stackoverflow.com/questions/1833588/javascript-clone-a-function">stackoverflow</a></p></li>
        
            <li><p>The table below is from MDN, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Enumerability_and_ownership_of_properties">Enumerability and ownership of properties</a>:</p>
<table>
<thead>
<tr>
<th></th>
<th>in</th>
<th>for..in</th>
<th>obj.hasOwnProperty</th>
<th>obj.propertyIsEnumerable</th>
<th>Object.keys</th>
<th>Object.getOwnPropertyNames</th>
<th>Object.getOwnPropertyDescriptors</th>
<th>Reflect.ownKeys()</th>
</tr>
</thead>
<tbody>
<tr>
<td>Enumerable</td>
<td><span style="background-color:#cfc;">true</span></td>
<td><span style="background-color:#cfc;">true</span></td>
<td><span style="background-color:#cfc;">true</span></td>
<td><span style="background-color:#cfc;">true</span></td>
<td><span style="background-color:#cfc;">true</span></td>
<td><span style="background-color:#cfc;">true</span></td>
<td><span style="background-color:#cfc;">true</span></td>
<td><span style="background-color:#cfc;">true</span></td>
</tr>
<tr>
<td>Nonenumerable</td>
<td><span style="background-color:#cfc;">true</span></td>
<td>false</td>
<td><span style="background-color:#cfc;">true</span></td>
<td>false</td>
<td>false</td>
<td><span style="background-color:#cfc;">true</span></td>
<td><span style="background-color:#cfc;">true</span></td>
<td><span style="background-color:#cfc;">true</span></td>
</tr>
<tr>
<td>Symbols keys</td>
<td><span style="background-color:#cfc;">true</span></td>
<td>false</td>
<td><span style="background-color:#cfc;">true</span></td>
<td><span style="background-color:#cfc;">true</span></td>
<td>false</td>
<td>false</td>
<td><span style="background-color:#cfc;">true</span></td>
<td><span style="background-color:#cfc;">true</span></td>
</tr>
<tr>
<td>Inherited Enumerable</td>
<td><span style="background-color:#cfc;">true</span></td>
<td><span style="background-color:#cfc;">true</span></td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
</tr>
<tr>
<td>Inherited Nonenumerable</td>
<td><span style="background-color:#cfc;">true</span></td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
</tr>
<tr>
<td>Inherited Symbols keys</td>
<td><span style="background-color:#cfc;">true</span></td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
</tr>
</tbody>
</table>
<p>... therefore, as <code>in</code> is not an iterating tool, there is no single
Sufficient tool for iterating through properties to perform deep cloning.</p>
<p>The MDN link above cites the following stackoverflow answer on,
'<a href="https://stackoverflow.com/questions/8024149/is-it-possible-to-get-the-non-enumerable-inherited-property-names-of-an-object/8024294#8024294">getting non-enumerable, ineherited, properties of an object</a>'
in deploying this pattern to walk up the prototype chain:</p>
<pre class="prettyprint source"><code>var accumulator
do  { // THINGS TO accumulator USING object
    } while ( object = Object.getPrototypeOf ( object ) )
return accumulator
</code></pre></li>
        
            <li><p>Symbols on MDN</p>
<ul>
<li>Perspective A: MDN, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol">Symbol</a>,
indicates that symbols add no outstanding benefit to performance or privacy,
and should be regarded as useful only for guaranteeing uniqueness of keys on
a per-runtime basis. Some OTP code has per-runtime variables, so we should
implement those using JavaScript symbols. But with regards to inter-runtime
communications, we don't want to try to send symbols over the wire. Also
there is probably no benefit to using Symbol to model Erlang's Atom.
<ul>
<li>Moreover, should we seek to use JSON.stringify() and JSON.parse() with
their 'replacer/replacer function' parameters, the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify">MDN docs</a>
indicate that <em>All Symbol-keyed properties will be completely ignored,
even when using the replacer/reviver function.</em></li>
</ul>
</li>
<li>Perspective B: Atoms should be modelled as <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol/for">Symbol.for()</a>
because these are respectively implemented in a very similar way, using a
look-up table under the hood. Note that Erlang's atom table is never garbage
collected; check on how JavaScript handles Symbol tables. Finally, before
deciding to use this, run performance tests on arbitrary-length string
comparisons, and Symbol comparisons where Symbol.for(keys), where keys are
arbitrary-length strings.</li>
</ul></li>
        
            <li><p>MDN, on JSON.parse() and JSON.stringify() using the <code>replacer/reviver function</code>
argument.</p>
<p>Specifically... note that <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify#toJSON_behavior">.toJSON() behaviour</a>
does NOT allow REFLECTION, and thus appears rather useless for our attempt
to serialise function objects. For example:</p>
<pre class="prettyprint source"><code>   var obj = {
       data: 'data',
       
       toJSON (key) {
           if (key)
               return `Now I am a nested object under key '${key}'`;
           else
               return this;
       }
   };

   JSON.stringify(obj);
   // '{&quot;data&quot;:&quot;data&quot;}'

   JSON.stringify({ obj })
   // '{&quot;obj&quot;:&quot;Now I am a nested object under key 'obj'&quot;}'

   JSON.stringify([ obj ])
   // '[&quot;Now I am a nested object under key '0'&quot;]'
</code></pre>
<p>... since <code>toJSON()</code> is a dead-end, we should return to the <code>replacer function</code> approach. Note however that the <a href="https://tc39.es/ecma262/#sec-serializejsonproperty">ECMA specification</a> requires toJSON() to parse a
<code>value</code> before that value is passed to any <code>replacer</code> function, so for
example: you can't detect Date object values in the replacer function using
<code>instance of Date</code> because they have already been converted to a string.
Therefore in order to work with this, we have to side-step the toJSON()
function before calling <code>JSON.stringify()</code>... D:</p></li>
        
            <li><p>Benchmark indicates that <code>String.slice()</code> is fastest: <a href="https://www.measurethat.net/Benchmarks/Show/6951/0/remove-first-and-last-characters-in-string">Remove First and Last Characters in String</a>.</p></li>
        
            <li>Measurethat.net benchmark indicates that for comparison of null vs.
 null, `===` is fastest, followed by `==`, and `Object.is()` is significantly
 slower.

 `switch-case` uses `===`

 `switch x - case y` with no `default`, and `if ( x === y)` with no `else` are the same. 

 Additional `-case`s are faster than additional `else`s.</li>
        
            <li><p>MDN on <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Strict_mode">strict mode</a>.</p>
<p><strong>Normal (long) function expressions:</strong> the <code>this</code> keyword in the function
body, will default to <code>undefined</code> instead of <code>globalThis</code>; yet <code>this</code> can be
assigned by <code>call() / bind() / apply()</code> to some other value, perhaps the
function object itself.</p>
<p><strong>Arrow function expressions:</strong> the <code>this</code> keyword in the function body,
will follow the enclosing scope's <code>this</code> as usual for arrow function
expressions.</p>
<p>Of note, MDN notes that <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions">arrow function expressions</a>
with function bodies invoking <code>use strict</code> WILL (abnormally) assign a value to
<code>this</code> INSIDE the function body, where the value is the value of <code>this</code> from
the surrounding lexical context. In other words, the strictness of an arrow
function body WILL NOT AFFECT ITS <code>this</code> value. <em>All other strict mode rules
apply normally.</em></p></li>
        
            <li>Serl will not explicitly support circular variable references, as these are not
 featured in Erlang.</li>
        </ul>
    </dd>
    

    
</dl>




















        
            

    

    
    <h4 class="name" id=".recurse"><span class="type-signature">(static) </span>recurse<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    <p>Utility function that helps reduce boilerplate in spawn/n for
recursing functions.</p>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="serl.js.html">serl.js</a>, <a href="serl.js.html#line676">line 676</a>
    </li></ul></dd>
    

    

    

    
    <dt class="tag-todo">To Do:</dt>
    <dd class="tag-todo">
        <ul>
            <li>Make 'recurse' work with all arities of spawn/n</li>
        </ul>
    </dd>
    
</dl>




















        
    

    
        <h3 class="subsection-title">Type Definitions</h3>

        
                
<h4 class="name" id=".NodeIndex">NodeIndex</h4>




<div class="description">
    <p>The primary location of values of
his type is at Node.nodeMap.counter. These are then used as keys of
<a href="module-Serl._Node_nodeMap_.html">Node.nodeMap</a>. They are also used as the
first integer value in the string representation of a <a href="module-Serl.Pid.html">Pid</a>.</p>
<p>This custom type exists only in documentation, and must be manually enforced
in code, by developers.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">integer</span>


        </li>
    </ul>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="serl.js.html">serl.js</a>, <a href="serl.js.html#line23">line 23</a>
    </li></ul></dd>
    

    

    

    
</dl>






            
                
<h4 class="name" id=".ProcIndex">ProcIndex</h4>




<div class="description">
    <p>The primary location of values of
this type is at Node.procMap.counter. These are then used as the second
integer value in the string representation of a <a href="module-Serl.Pid.html">Pid</a>. ** UNLIKE <a href="module-Serl.html#.NodeIndex">NodeIndex</a>, these
are NOT keys of <a href="module-Serl._Node_procMap_.html">Node.procMap</a>. **</p>
<p>This custom type exists only in documentation, and must be manually enforced
in code, by developers.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">integer</span>


        </li>
    </ul>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="serl.js.html">serl.js</a>, <a href="serl.js.html#line35">line 35</a>
    </li></ul></dd>
    

    

    

    
</dl>






            
    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-Serl.html">Serl</a></li></ul><h3>Namespaces</h3><ul><li><a href="module-Serl._Node_nodeMap_.html">'Node#nodeMap'</a></li><li><a href="module-Serl._Node_procMap_.html">'Node#procMap'</a></li></ul><h3>Classes</h3><ul><li><a href="module-Serl.Node.html">Node</a></li><li><a href="module-Serl.Pid.html">Pid</a></li><li><a href="module-Serl.Proc.html">Proc</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Wed Jan 29 2020 15:12:40 GMT+0800 (Malaysia Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>